<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>燃情岁月</title>
  
  <subtitle>嘿嘿嘿</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://qq1028951741.github.io/"/>
  <updated>2019-05-30T12:26:58.872Z</updated>
  <id>https://qq1028951741.github.io/</id>
  
  <author>
    <name>fufua</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>elasticsearch 安装</title>
    <link href="https://qq1028951741.github.io/2019/05/30/elasticsearch%20%E5%AE%89%E8%A3%85/"/>
    <id>https://qq1028951741.github.io/2019/05/30/elasticsearch 安装/</id>
    <published>2019-05-30T02:54:13.000Z</published>
    <updated>2019-05-30T12:26:58.872Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="elasticsearch-安装"><a href="#elasticsearch-安装" class="headerlink" title="elasticsearch 安装"></a>elasticsearch 安装</h2><h3 id="下载elasticsearch-zip文件"><a href="#下载elasticsearch-zip文件" class="headerlink" title="下载elasticsearch zip文件"></a>下载elasticsearch zip文件</h3><p><a href="https://www.elastic.co/downloads/past-releases/elasticsearch-6-2-2" target="_blank" rel="noopener">https://www.elastic.co/downloads/past-releases/elasticsearch-6-2-2</a></p><h3 id="安装kibana"><a href="#安装kibana" class="headerlink" title="安装kibana"></a>安装kibana</h3><ul><li>用于在浏览器中访问es,请下载6.2.2版本</li><li>下载地址：<a href="https://www.elastic.co/downloads/kibana" target="_blank" rel="noopener">https://www.elastic.co/downloads/kibana</a></li><li>下载.zip包后解压即可，运行bin\kibana.bat，访问<a href="http://localhost:5601" target="_blank" rel="noopener">http://localhost:5601</a> 查看是否安装成功</li></ul><h3 id="安装中文分词插件"><a href="#安装中文分词插件" class="headerlink" title="安装中文分词插件"></a>安装中文分词插件</h3><ul><li>下载地址：<a href="https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.2.2/elasticsearch-analysis-ik-6.2.2.zip" target="_blank" rel="noopener">https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.2.2/elasticsearch-analysis-ik-6.2.2.zip</a></li><li>在elasticsearch-6.2.2\bin目录下执行以下命令： elasticsearch-plugin install </li><li>启动elasticsearch:运行elasticsearch-6.2.2\bin\elasticsearch.bat</li></ul><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="elasticsearch" scheme="https://qq1028951741.github.io/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>rabbitmq 安装</title>
    <link href="https://qq1028951741.github.io/2019/05/30/rabbitmq%20%E5%AE%89%E8%A3%85/"/>
    <id>https://qq1028951741.github.io/2019/05/30/rabbitmq 安装/</id>
    <published>2019-05-30T02:54:13.000Z</published>
    <updated>2019-05-30T12:20:33.023Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="rabbitmq-安装"><a href="#rabbitmq-安装" class="headerlink" title="rabbitmq 安装"></a>rabbitmq 安装</h2><ul><li>安装Erlang：<a href="http://erlang.org/download/otp_win64_21.3.exe" target="_blank" rel="noopener">http://erlang.org/download/otp_win64_21.3.exe</a></li><li>下载rabbitmq：<a href="https://dl.bintray.com/rabbitmq/all/rabbitmq-server/3.7.14/rabbitmq-server-3.7.14.exe" target="_blank" rel="noopener">https://dl.bintray.com/rabbitmq/all/rabbitmq-server/3.7.14/rabbitmq-server-3.7.14.exe</a></li><li>按照提示进行安装，安装完成后进入rabbitmq的安装目录:D:\RabbitMQ Server\rabbitmq_server-3.7.14\sbin</li><li>在地址栏输入cmd并回车启动命令行输入以下命令：rabbitmq-plugins enable rabbitmq_management</li><li>访问地址查看是否安装成功：<a href="http://127.0.0.1:15672/" target="_blank" rel="noopener">http://127.0.0.1:15672/</a></li><li>输入账号密码登录：guest guest</li><li>创建用户并设置其角色为管理员：mall mall </li></ul><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="rabbitmq" scheme="https://qq1028951741.github.io/tags/rabbitmq/"/>
    
  </entry>
  
  <entry>
    <title>mongodb 安装</title>
    <link href="https://qq1028951741.github.io/2019/05/30/mongodb%20%E5%AE%89%E8%A3%85/"/>
    <id>https://qq1028951741.github.io/2019/05/30/mongodb 安装/</id>
    <published>2019-05-30T02:54:13.000Z</published>
    <updated>2019-05-30T12:29:15.564Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="mongodb-安装"><a href="#mongodb-安装" class="headerlink" title="mongodb 安装"></a>mongodb 安装</h2><ul><li>下载地址：<a href="https://fastdl.mongodb.org/win32/mongodb-win32-x86_64-2008plus-ssl-3.2.21-signed.msi" target="_blank" rel="noopener">https://fastdl.mongodb.org/win32/mongodb-win32-x86_64-2008plus-ssl-3.2.21-signed.msi</a></li><li>选择路径（c:\mongodb\）进行安装，在安装路径下创建data\db和data\log两个文件夹</li><li>服务端运行程序：mongodb\bin\mongod.exe</li><li>客户端运行程序：mongodb\bin\mongo.exe</li><li><p>创建配置文件：mongodb\mongod.cfg</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemLog:</span><br><span class="line">    destination: file</span><br><span class="line">    path: c:\mongodb\data\log\mongod.log</span><br><span class="line">storage:</span><br><span class="line">    dbPath: c:\mongodb\data\db</span><br></pre></td></tr></table></figure></li><li><p>安装为服务（运行命令需要用管理员权限）：C:\mongodb\bin\mongod.exe –config “C:\mongodb\mongod.cfg” –install</p></li><li>启动服务：net start MongoDB</li><li>关闭服务：net stop MongoDB</li><li>移除服务：C:\mongodb\bin\mongod.exe - -remove</li><li>下载客户端程序：<a href="https://download.robomongo.org/1.2.1/windows/robo3t-1.2.1-windows-x86_64-3e50a65.zip" target="_blank" rel="noopener">https://download.robomongo.org/1.2.1/windows/robo3t-1.2.1-windows-x86_64-3e50a65.zip</a></li><li>解压到指定目录，打开robo3t.exe并连接到localhost:27017</li></ul><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="mongodb" scheme="https://qq1028951741.github.io/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>Controller返回结果拦截器</title>
    <link href="https://qq1028951741.github.io/2019/05/27/Controller%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E6%8B%A6%E6%88%AA%E5%99%A8/"/>
    <id>https://qq1028951741.github.io/2019/05/27/Controller返回结果拦截器/</id>
    <published>2019-05-27T02:54:13.000Z</published>
    <updated>2019-05-27T12:38:24.680Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="Controller返回结果拦截器"><a href="#Controller返回结果拦截器" class="headerlink" title="Controller返回结果拦截器"></a>Controller返回结果拦截器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">package com.gosun.common.config;</span><br><span class="line"></span><br><span class="line">import com.alibaba.fastjson.JSONArray;</span><br><span class="line">import com.alibaba.fastjson.JSONObject;</span><br><span class="line">import com.gosun.common.dao.UserDao;</span><br><span class="line">import com.gosun.common.entity.ChildPlatform;</span><br><span class="line">import com.gosun.common.entity.Role;</span><br><span class="line">import com.gosun.common.entity.User;</span><br><span class="line">import com.gosun.common.feign.UserFeignClient;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.core.MethodParameter;</span><br><span class="line">import org.springframework.http.MediaType;</span><br><span class="line">import org.springframework.http.server.ServerHttpRequest;</span><br><span class="line">import org.springframework.http.server.ServerHttpResponse;</span><br><span class="line">import org.springframework.security.core.Authentication;</span><br><span class="line">import org.springframework.security.core.context.SecurityContextHolder;</span><br><span class="line">import org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line">import org.springframework.web.servlet.mvc.method.annotation.ResponseBodyAdvice;</span><br><span class="line"></span><br><span class="line">import java.util.HashSet;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.Set;</span><br><span class="line"></span><br><span class="line">@ControllerAdvice</span><br><span class="line">public class ResponseBodyAnalysis implements ResponseBodyAdvice &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    UserFeignClient userFeignClient;</span><br><span class="line">    @Autowired</span><br><span class="line">    UserDao userDao;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Object beforeBodyWrite(Object body, MethodParameter arg1,</span><br><span class="line">                                  MediaType arg2, Class arg3, ServerHttpRequest arg4,</span><br><span class="line">                                  ServerHttpResponse arg5) &#123;</span><br><span class="line">        if(!arg4.getURI().getPath().contains(&quot;oauth/token&quot;)</span><br><span class="line">                &amp;&amp; !arg4.getURI().getPath().contains(&quot;oauth/check_token&quot;)</span><br><span class="line">                &amp;&amp; !arg4.getURI().getPath().contains(&quot;swagger-resources&quot;)</span><br><span class="line">                &amp;&amp; !arg4.getURI().getPath().contains(&quot;api-docs&quot;)</span><br><span class="line">                &amp;&amp; !arg4.getURI().getPath().contains(&quot;error&quot;))&#123;</span><br><span class="line">            Authentication authentication = SecurityContextHolder.getContext().getAuthentication();</span><br><span class="line">            Map map = (Map)body;</span><br><span class="line">            JSONObject jsonObject = new JSONObject(map);</span><br><span class="line">            JSONArray jsonArray = jsonObject.getJSONArray(&quot;data&quot;);</span><br><span class="line">            if(jsonArray != null)&#123;</span><br><span class="line">                Set&lt;ChildPlatform&gt; childPlatforms = findChildPlatformAuthority((String) authentication.getPrincipal());</span><br><span class="line">                for(int i=0;i&lt;jsonArray.size();i++)&#123;</span><br><span class="line">                    JSONObject jsonData = jsonArray.getJSONObject(i);</span><br><span class="line">                    if(jsonData.getString(&quot;childPlatCode&quot;) != null)&#123;</span><br><span class="line">                        String childPlatCode = jsonData.getString(&quot;childPlatCode&quot;);</span><br><span class="line">                        Boolean flag = false;</span><br><span class="line">                        for(ChildPlatform childPlatform:childPlatforms)&#123;</span><br><span class="line">                            if(childPlatform.getChildPlatCode().equals(childPlatCode))&#123;</span><br><span class="line">                                flag = true;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        if(!flag)&#123;</span><br><span class="line">                            jsonArray.remove(jsonData);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return body;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean supports(MethodParameter arg0, Class arg1) &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Set&lt;ChildPlatform&gt; findChildPlatformAuthority(String userName)&#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            User user = userDao.findByUsername(userName);</span><br><span class="line">            Set&lt;Role&gt; roles = user.getRoles();</span><br><span class="line">            Set&lt;ChildPlatform&gt; resultSet = new HashSet&lt;&gt;();</span><br><span class="line">            for(Role role:roles)&#123;</span><br><span class="line">                resultSet.addAll(role.getChildPlatforms());</span><br><span class="line">            &#125;</span><br><span class="line">            return resultSet;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="拦截器" scheme="https://qq1028951741.github.io/tags/%E6%8B%A6%E6%88%AA%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>下划线字符串和驼峰法字符串转换工具</title>
    <link href="https://qq1028951741.github.io/2019/05/27/%E4%B8%8B%E5%88%92%E7%BA%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E9%A9%BC%E5%B3%B0%E6%B3%95%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2%E5%B7%A5%E5%85%B7/"/>
    <id>https://qq1028951741.github.io/2019/05/27/下划线字符串和驼峰法字符串转换工具/</id>
    <published>2019-05-27T02:54:13.000Z</published>
    <updated>2019-05-27T09:04:29.479Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="下划线字符串和驼峰法字符串转换工具"><a href="#下划线字符串和驼峰法字符串转换工具" class="headerlink" title="下划线字符串和驼峰法字符串转换工具"></a>下划线字符串和驼峰法字符串转换工具</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">package com.*.common.util;</span><br><span class="line"></span><br><span class="line">import java.util.regex.Matcher;</span><br><span class="line">import java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @Autor : zyf</span><br><span class="line"> */</span><br><span class="line">public class UnderlineToCamelUtil &#123;</span><br><span class="line"></span><br><span class="line">    public static final char UNDERLINE=&apos;_&apos;;</span><br><span class="line">    private static Pattern UNDERLINE_PATTERN = Pattern.compile(&quot;_&quot;);</span><br><span class="line"></span><br><span class="line">    public static String camelToUnderline(String param)&#123;</span><br><span class="line">        if (param==null||&quot;&quot;.equals(param.trim()))&#123;</span><br><span class="line">            return &quot;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        int len=param.length();</span><br><span class="line">        StringBuilder sb=new StringBuilder(len);</span><br><span class="line">        for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">            char c=param.charAt(i);</span><br><span class="line">            if (Character.isUpperCase(c))&#123;</span><br><span class="line">                sb.append(UNDERLINE);</span><br><span class="line">                sb.append(Character.toLowerCase(c));</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                sb.append(c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * 下划线转驼峰</span><br><span class="line">     * @param param</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static String underlineToCamel(String param)&#123;</span><br><span class="line">        if (param==null||&quot;&quot;.equals(param.trim()))&#123;</span><br><span class="line">            return &quot;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        int len=param.length();</span><br><span class="line">        StringBuilder sb=new StringBuilder(len);</span><br><span class="line">        for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">            char c=param.charAt(i);</span><br><span class="line">            if (c==UNDERLINE)&#123;</span><br><span class="line">                if (++i&lt;len)&#123;</span><br><span class="line">                    sb.append(Character.toUpperCase(param.charAt(i)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                sb.append(c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    public static String underlineToCamel2(String param)&#123;</span><br><span class="line">        if (param==null||&quot;&quot;.equals(param.trim()))&#123;</span><br><span class="line">            return &quot;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        StringBuilder sb=new StringBuilder(param);</span><br><span class="line">        Matcher mc = UNDERLINE_PATTERN.matcher(param);</span><br><span class="line">        int i=0;</span><br><span class="line">        while (mc.find())&#123;</span><br><span class="line">            int position=mc.end()-(i++);</span><br><span class="line">            //String.valueOf(Character.toUpperCase(sb.charAt(position)));</span><br><span class="line">            sb.replace(position-1,position+1,sb.substring(position,position+1).toUpperCase());</span><br><span class="line">        &#125;</span><br><span class="line">        return sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        System.out.println(underlineToCamel(&quot;a_b_c&quot;));</span><br><span class="line">        System.out.println(underlineToCamel2(&quot;a_b_c&quot;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="类工具" scheme="https://qq1028951741.github.io/tags/%E7%B1%BB%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot JPA EntityManager构建通用DAO</title>
    <link href="https://qq1028951741.github.io/2019/05/27/SpringBoot%20JPA%20EntityManager%E6%9E%84%E5%BB%BA%E9%80%9A%E7%94%A8DAO/"/>
    <id>https://qq1028951741.github.io/2019/05/27/SpringBoot JPA EntityManager构建通用DAO/</id>
    <published>2019-05-27T02:43:13.000Z</published>
    <updated>2019-05-27T09:39:38.760Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="SpringBoot-JPA-EntityManager构建通用DAO"><a href="#SpringBoot-JPA-EntityManager构建通用DAO" class="headerlink" title="SpringBoot JPA EntityManager构建通用DAO"></a>SpringBoot JPA EntityManager构建通用DAO</h2><blockquote><p>EntityManager 是用来对实体Bean 进行操作的辅助类。他可以用来产生/删除持久化的实体Bean，通过主键查找实体bean，也可以通过EJB3 QL 语言查找满足条件的实体Bean。实体Bean 被EntityManager 管理时，EntityManager跟踪他的状态改变，在任何决定更新实体Bean 的时候便会把发生改变的值同步到数据库中。当实体Bean 从EntityManager 分离后，他是不受管理的，EntityManager 无法跟踪他的任何状态改变。EntityManager 的获取前面已经介绍过，可以通过@PersistenceContext 注释由EJB 容器动态注入。</p></blockquote><h3 id="entitymanager的一些方法"><a href="#entitymanager的一些方法" class="headerlink" title="entitymanager的一些方法"></a>entitymanager的一些方法</h3><ul><li>persist() :添加实体Bean</li><li>flush() ：将实体的改变立刻刷新到数据库中</li><li>merge () :比较麻烦，用好了很不错，配合flush</li><li>Remove() :删除对象</li><li>createQuery() ：返回Query对象,以执行JPQL语句</li><li>createNativeQuery() ：返回Query对象,以执行SQL语句</li><li>refresh() ：刷新实体Bean,以得到对新对象</li><li>contains()： 检测实体当前是否被管理中</li><li>clear() 分离所有当前正在被管理的实体</li></ul><h3 id="EntityManager构建通用DAO"><a href="#EntityManager构建通用DAO" class="headerlink" title="EntityManager构建通用DAO"></a>EntityManager构建通用DAO</h3><ul><li><p>BaseDAO</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">public interface BaseAppDAO&lt;T,ID extends Serializable&gt; &#123;</span><br><span class="line">    /**</span><br><span class="line">     * 保存数据对象</span><br><span class="line">     * @param entity</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    boolean save(T entity);</span><br><span class="line">    /**</span><br><span class="line">     * 根据id查询</span><br><span class="line">     * @param id</span><br><span class="line">     * @param t</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    T findByid(T t,Long id);</span><br><span class="line">    /**</span><br><span class="line">     * 根据表名，字段，参数查询，拼接sql语句</span><br><span class="line">     * @param  tablename 表名</span><br><span class="line">     * @param filed 字段名</span><br><span class="line">     * @param o 字段参数</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    List&lt;T&gt; findBysql(String tablename,String filed,Object o);</span><br><span class="line">    Object findObjiectBysql(String tablename,String filed,Object o);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 多个字段的查询</span><br><span class="line">     * @param tablename 表名</span><br><span class="line">     * @param map 将你的字段传入map中</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    List&lt;T&gt; findByMoreFiled(String tablename,LinkedHashMap&lt;String,Object&gt; map);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 多字段查询分页</span><br><span class="line">     * @param tablename 表名</span><br><span class="line">     * @param map 以map存储key,value</span><br><span class="line">     * @param start 第几页</span><br><span class="line">     * @param pageNumer 一个页面的条数</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    List&lt;T&gt; findByMoreFiledpages(String tablename, LinkedHashMap&lt;String,Object&gt; map, int start, int pageNumer);</span><br><span class="line">    /**</span><br><span class="line">     * 一个字段的分页</span><br><span class="line">     * @param  tablename 表名</span><br><span class="line">     * @param filed 字段名</span><br><span class="line">     * @param o 字段参数</span><br><span class="line">     * @param start 第几页</span><br><span class="line">     * @param pageNumer 一个页面多少条数据</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    List&lt;T&gt; findpages(String tablename,String filed,Object o,int start,int pageNumer);</span><br><span class="line">    /**</span><br><span class="line">     * 根据表的id删除数据</span><br><span class="line">     * @param  entity</span><br><span class="line">     */</span><br><span class="line">    boolean delete(T entity);</span><br><span class="line">    /**</span><br><span class="line">     * 更新对象</span><br><span class="line">     * @param e</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    boolean update(T e);</span><br><span class="line">    /**</span><br><span class="line">     * 根据传入的map遍历key,value拼接字符串，以id为条件更新</span><br><span class="line">     * @param tablename 表名</span><br><span class="line">     * @param map 传入参数放入map中</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    Integer updateMoreFiled(String tablename,LinkedHashMap&lt;String,Object&gt; map);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据条件查询总条数返回object类型</span><br><span class="line">     * @param tablename  表名</span><br><span class="line">     * @param map 传入参数放入map中</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    Object findCount(String tablename, LinkedHashMap&lt;String,Object&gt; map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>实现类BaseDAOimpl<br>其中值得注意用@PersistenceContext动态注入Entitymanager,@Transactional事务的注入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line">@Repository</span><br><span class="line">public class BaseAppDAOimpl&lt;T,ID extends Serializable&gt; implements BaseAppDAO&lt;T,ID&gt; &#123;</span><br><span class="line"></span><br><span class="line">    @PersistenceContext</span><br><span class="line">    private EntityManager entityManager;</span><br><span class="line">    @Transactional</span><br><span class="line">    @Override</span><br><span class="line">    public boolean save(T entity)&#123;</span><br><span class="line">        boolean flag=false;</span><br><span class="line">        try &#123;</span><br><span class="line">            entityManager.persist(entity);</span><br><span class="line">            flag=true;</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            System.out.println(&quot;---------------保存出错---------------&quot;);</span><br><span class="line">            throw e;</span><br><span class="line">        &#125;</span><br><span class="line">        return flag;</span><br><span class="line">    &#125;</span><br><span class="line">    @Transactional</span><br><span class="line">    @Override</span><br><span class="line">    public Object findByid(Object o,Long id) &#123;</span><br><span class="line">        return entityManager.find(o.getClass(),id);</span><br><span class="line">    &#125;</span><br><span class="line">    @Transactional</span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;T&gt; findBysql(String tablename, String filed, Object o ) &#123;</span><br><span class="line">        String sql=&quot;from &quot;+tablename+&quot; u WHERE u.&quot;+filed+&quot;=?&quot;;</span><br><span class="line">        System.out.println(sql+&quot;--------sql语句-------------&quot;);</span><br><span class="line">        Query query=entityManager.createQuery(sql);</span><br><span class="line">        query.setParameter(1,o);</span><br><span class="line">        List&lt;T&gt; list= query.getResultList();</span><br><span class="line">        entityManager.close();</span><br><span class="line">        return list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Object findObjiectBysql(String tablename, String filed, Object o) &#123;</span><br><span class="line">        String sql=&quot;from &quot;+tablename+&quot; u WHERE u.&quot;+filed+&quot;=?&quot;;</span><br><span class="line">        System.out.println(sql+&quot;--------sql语句-------------&quot;);</span><br><span class="line">        Query query=entityManager.createQuery(sql);</span><br><span class="line">        query.setParameter(1,o);</span><br><span class="line"></span><br><span class="line">        entityManager.close();</span><br><span class="line">        return query.getSingleResult();</span><br><span class="line">    &#125;</span><br><span class="line">    @Transactional</span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;T&gt; findByMoreFiled(String tablename,LinkedHashMap&lt;String,Object&gt; map) &#123;</span><br><span class="line">        String sql=&quot;from &quot;+tablename+&quot; u WHERE &quot;;</span><br><span class="line">        Set&lt;String&gt; set=null;</span><br><span class="line">        set=map.keySet();</span><br><span class="line">        List&lt;String&gt; list=new ArrayList&lt;&gt;(set);</span><br><span class="line">        List&lt;Object&gt; filedlist=new ArrayList&lt;&gt;();</span><br><span class="line">        for (String filed:list)&#123;</span><br><span class="line">            sql+=&quot;u.&quot;+filed+&quot;=? and &quot;;</span><br><span class="line">            filedlist.add(filed);</span><br><span class="line">        &#125;</span><br><span class="line">        sql=sql.substring(0,sql.length()-4);</span><br><span class="line">        System.out.println(sql+&quot;--------sql语句-------------&quot;);</span><br><span class="line">        Query query=entityManager.createQuery(sql);</span><br><span class="line">        for (int i=0;i&lt;filedlist.size();i++)&#123;</span><br><span class="line">            query.setParameter(i+1,map.get(filedlist.get(i)));</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;T&gt; listRe= query.getResultList();</span><br><span class="line">        entityManager.close();</span><br><span class="line">        return listRe;</span><br><span class="line">    &#125;</span><br><span class="line">    @Transactional</span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;T&gt; findByMoreFiledpages(String tablename,LinkedHashMap&lt;String,Object&gt; map,int start,int pageNumber) &#123;</span><br><span class="line">        String sql=&quot;from &quot;+tablename+&quot; u WHERE &quot;;</span><br><span class="line">        Set&lt;String&gt; set=null;</span><br><span class="line">        set=map.keySet();</span><br><span class="line">        List&lt;String&gt; list=new ArrayList&lt;&gt;(set);</span><br><span class="line">        List&lt;Object&gt; filedlist=new ArrayList&lt;&gt;();</span><br><span class="line">        for (String filed:list)&#123;</span><br><span class="line">            sql+=&quot;u.&quot;+filed+&quot;=? and &quot;;</span><br><span class="line">            filedlist.add(filed);</span><br><span class="line">        &#125;</span><br><span class="line">        sql=sql.substring(0,sql.length()-4);</span><br><span class="line">        System.out.println(sql+&quot;--------sql语句-------------&quot;);</span><br><span class="line">        Query query=entityManager.createQuery(sql);</span><br><span class="line">        for (int i=0;i&lt;filedlist.size();i++)&#123;</span><br><span class="line">            query.setParameter(i+1,map.get(filedlist.get(i)));</span><br><span class="line">        &#125;</span><br><span class="line">        query.setFirstResult((start-1)*pageNumber);</span><br><span class="line">        query.setMaxResults(pageNumber);</span><br><span class="line">        List&lt;T&gt; listRe= query.getResultList();</span><br><span class="line">        entityManager.close();</span><br><span class="line">        return listRe;</span><br><span class="line">    &#125;</span><br><span class="line">    @Transactional</span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;T&gt; findpages(String tablename, String filed, Object o, int start, int pageNumer) &#123;</span><br><span class="line">        String sql=&quot;from &quot;+tablename+&quot; u WHERE u.&quot;+filed+&quot;=?&quot;;</span><br><span class="line">        System.out.println(sql+&quot;--------page--sql语句-------------&quot;);</span><br><span class="line">        List&lt;T&gt; list=new ArrayList&lt;&gt;();</span><br><span class="line">        try &#123;</span><br><span class="line">            Query query=entityManager.createQuery(sql);</span><br><span class="line">            query.setParameter(1,o);</span><br><span class="line">            query.setFirstResult((start-1)*pageNumer);</span><br><span class="line">            query.setMaxResults(pageNumer);</span><br><span class="line">            list= query.getResultList();</span><br><span class="line">            entityManager.close();</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            System.out.println(&quot;------------分页错误---------------&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return list;</span><br><span class="line">    &#125;</span><br><span class="line">    @Transactional</span><br><span class="line">    @Override</span><br><span class="line">    public boolean update(T entity) &#123;</span><br><span class="line">        boolean flag = false;</span><br><span class="line">        try &#123;</span><br><span class="line">            entityManager.merge(entity);</span><br><span class="line">            flag = true;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            System.out.println(&quot;---------------更新出错---------------&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        return flag;</span><br><span class="line">    &#125;</span><br><span class="line">    @Transactional</span><br><span class="line">    @Override</span><br><span class="line">    public Integer updateMoreFiled(String tablename, LinkedHashMap&lt;String, Object&gt; map) &#123;</span><br><span class="line">        String sql=&quot;UPDATE &quot;+tablename+&quot; AS u SET &quot;;</span><br><span class="line">        Set&lt;String&gt; set=null;</span><br><span class="line">        set=map.keySet();</span><br><span class="line">        List&lt;String&gt; list=new ArrayList&lt;&gt;(set);</span><br><span class="line">        for (int i=0;i&lt;list.size()-1;i++)&#123;</span><br><span class="line">            if (map.get(list.get(i)).getClass().getTypeName()==&quot;java.lang.String&quot;)&#123;</span><br><span class="line">                System.out.println(&quot;-*****&quot;+map.get(list.get(i))+&quot;------------&quot;+list.get(i));</span><br><span class="line">                sql+=&quot;u.&quot;+list.get(i)+&quot;=&apos;&quot;+map.get(list.get(i))+&quot;&apos; , &quot;;</span><br><span class="line">            &#125;else &#123;</span><br><span class="line">                sql+=&quot;u.&quot;+list.get(i)+&quot;=&quot;+map.get(list.get(i))+&quot; , &quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sql=sql.substring(0,sql.length()-2);</span><br><span class="line">        sql+=&quot;where u.id=? &quot;;</span><br><span class="line">        System.out.println(sql+&quot;--------sql语句-------------&quot;);</span><br><span class="line">        int resurlt=0;</span><br><span class="line">        try &#123;</span><br><span class="line">            Query query=entityManager.createQuery(sql);</span><br><span class="line">            query.setParameter(1,map.get(&quot;id&quot;));</span><br><span class="line">            resurlt= query.executeUpdate();</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            System.out.println(&quot;更新出错-----------------------&quot;);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        return resurlt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Transactional</span><br><span class="line">    @Override</span><br><span class="line">    public boolean delete(T entity) &#123;</span><br><span class="line">        boolean flag=false;</span><br><span class="line">        try &#123;</span><br><span class="line">            entityManager.remove(entityManager.merge(entity));</span><br><span class="line">            flag=true;</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            System.out.println(&quot;---------------删除出错---------------&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        return flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Object findCount(String tablename, LinkedHashMap&lt;String, Object&gt; map) &#123;</span><br><span class="line">        String sql=&quot;select count(u) from &quot;+tablename+&quot; u WHERE &quot;;</span><br><span class="line">        Set&lt;String&gt; set=null;</span><br><span class="line">        set=map.keySet();</span><br><span class="line">        List&lt;String&gt; list=new ArrayList&lt;&gt;(set);</span><br><span class="line">        List&lt;Object&gt; filedlist=new ArrayList&lt;&gt;();</span><br><span class="line">        for (String filed:list)&#123;</span><br><span class="line">            sql+=&quot;u.&quot;+filed+&quot;=? and &quot;;</span><br><span class="line">            filedlist.add(filed);</span><br><span class="line">        &#125;</span><br><span class="line">        sql=sql.substring(0,sql.length()-4);</span><br><span class="line">        System.out.println(sql+&quot;--------sql语句-------------&quot;);</span><br><span class="line">        Query query=entityManager.createQuery(sql);</span><br><span class="line">        for (int i=0;i&lt;filedlist.size();i++)&#123;</span><br><span class="line">            query.setParameter(i+1,map.get(filedlist.get(i)));</span><br><span class="line">        &#125;</span><br><span class="line">        return query.getSingleResult();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr><p>  ​    </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="SpringBoot整合系列" scheme="https://qq1028951741.github.io/categories/SpringBoot%E6%95%B4%E5%90%88%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="SpringBoot" scheme="https://qq1028951741.github.io/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>Alibaba Coding Guidelines插件使用记录</title>
    <link href="https://qq1028951741.github.io/2019/05/17/Alibaba%20Coding%20Guidelines%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"/>
    <id>https://qq1028951741.github.io/2019/05/17/Alibaba Coding Guidelines插件使用记录/</id>
    <published>2019-05-17T02:54:13.000Z</published>
    <updated>2019-05-29T07:36:02.521Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="Alibaba-Coding-Guidelines插件使用记录"><a href="#Alibaba-Coding-Guidelines插件使用记录" class="headerlink" title="Alibaba Coding Guidelines插件使用记录"></a>Alibaba Coding Guidelines插件使用记录</h2><blockquote><p>此篇文章为公司代码使用Alibaba Coding Guidelines插件进行编码规范优化，特此记录以供后面学习。– 22</p></blockquote><ul><li><p>long或者Long初始赋值时，必须使用大写的L，不能是小写的l，小写容易跟数字1混淆，造成误解。 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Negative example:</span><br><span class="line">    //It is hard to tell whether it is number 11 or Long 1.</span><br><span class="line">    Long warn = 1l;              </span><br><span class="line">Positive example:</span><br><span class="line">    Long notwarn = 1L;</span><br></pre></td></tr></table></figure></li><li><p>在if/else/for/while/do语句中必须使用大括号，即使只有一行代码，避免使用下面的形式：if (condition) statements; – 796</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (flag) &#123;</span><br><span class="line">            System.out.println(&quot;hello world&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ul><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="java编码规范" scheme="https://qq1028951741.github.io/tags/java%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot：FatJar减肥解决SpringBoot jar包太大的问题</title>
    <link href="https://qq1028951741.github.io/2019/04/26/SpringBoot%EF%BC%9AFatJar%E5%87%8F%E8%82%A5%E8%A7%A3%E5%86%B3SpringBoot%20jar%E5%8C%85%E5%A4%AA%E5%A4%A7%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>https://qq1028951741.github.io/2019/04/26/SpringBoot：FatJar减肥解决SpringBoot jar包太大的问题/</id>
    <published>2019-04-26T02:43:13.000Z</published>
    <updated>2019-04-26T02:47:07.647Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="SpringBoot：FatJar减肥解决SpringBoot-jar包太大的问题"><a href="#SpringBoot：FatJar减肥解决SpringBoot-jar包太大的问题" class="headerlink" title="SpringBoot：FatJar减肥解决SpringBoot jar包太大的问题"></a>SpringBoot：FatJar减肥解决SpringBoot jar包太大的问题</h2><blockquote><p>spring boot添加spring-boot-maven-plugin插件后, 打出来的Jar动辄几十上百兆. 这种FatJar包在传输时会相当不便</p></blockquote><h3 id="修改spring-boot-maven-plugin，抽取依赖到指定目录"><a href="#修改spring-boot-maven-plugin，抽取依赖到指定目录" class="headerlink" title="修改spring-boot-maven-plugin，抽取依赖到指定目录"></a>修改spring-boot-maven-plugin，抽取依赖到指定目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;build&gt;</span><br><span class="line">&lt;plugins&gt;</span><br><span class="line">&lt;plugin&gt;</span><br><span class="line">&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;2.6&lt;/version&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;archive&gt;</span><br><span class="line">&lt;manifest&gt;</span><br><span class="line">&lt;addClasspath&gt;true&lt;/addClasspath&gt;</span><br><span class="line">&lt;classpathPrefix&gt;lib/&lt;/classpathPrefix&gt;</span><br><span class="line">&lt;mainClass&gt;com.gosun.EurekaServerApplication&lt;/mainClass&gt;</span><br><span class="line">&lt;/manifest&gt;</span><br><span class="line">&lt;/archive&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br><span class="line">&lt;plugin&gt;</span><br><span class="line">&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;3.1.1&lt;/version&gt;</span><br><span class="line">&lt;executions&gt;</span><br><span class="line">&lt;execution&gt;</span><br><span class="line">&lt;id&gt;copy-dependencies&lt;/id&gt;</span><br><span class="line">&lt;phase&gt;package&lt;/phase&gt;</span><br><span class="line">&lt;goals&gt;</span><br><span class="line">&lt;goal&gt;copy-dependencies&lt;/goal&gt;</span><br><span class="line">&lt;/goals&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;outputDirectory&gt;E:/lib&lt;/outputDirectory&gt;</span><br><span class="line">&lt;excludeGroupIds&gt;</span><br><span class="line">&lt;!-- 留存于fat jar中的jar包的groupId属性值（多个,分隔）--&gt;</span><br><span class="line">&lt;/excludeGroupIds&gt;</span><br><span class="line">&lt;overWriteSnapshots&gt;true&lt;/overWriteSnapshots&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line">&lt;/execution&gt;</span><br><span class="line">&lt;/executions&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br><span class="line">&lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br></pre></td></tr></table></figure><p>其中，maven-jar-plugin是为了解决fatjar瘦身后运行会提示*-0.0.1-SNAPSHOT.jar中没有主清单属性的问题</p><h3 id="将上一步exclude掉的jar放到一个外置的目录中"><a href="#将上一步exclude掉的jar放到一个外置的目录中" class="headerlink" title="将上一步exclude掉的jar放到一个外置的目录中"></a>将上一步exclude掉的jar放到一个外置的目录中</h3><p>  <img src="/images/fatjar.png" alt="&quot;图片描述&quot;"></p><h3 id="运行jar包"><a href="#运行jar包" class="headerlink" title="运行jar包"></a>运行jar包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@ echo off</span><br><span class="line"></span><br><span class="line">::eureka-server</span><br><span class="line">start cmd /c &quot;title eureka-server &amp;&amp; java  -Dloader.path=&quot;lib/&quot; -jar eureka-server-0.0.1-SNAPSHOT.jar --DASPush=false --server.port=1001 &gt; log\eureka-server.log 2&gt;&amp;1 &amp;&quot;</span><br><span class="line">::config-server-native</span><br><span class="line">start cmd /c &quot;title config-server-native &amp;&amp; java  -Dloader.path=&quot;lib/&quot; -jar config-server-native-0.0.1-SNAPSHOT.jar --DASPush=false --server.port=3001 &gt; log\config-server-native.log 2&gt;&amp;1 &amp;&quot;</span><br><span class="line"></span><br><span class="line">pause</span><br></pre></td></tr></table></figure><p>java -Dloader.path=”lib/“ -jar common-service.jar执行语句中loader.path指向了外置目录,告诉springboot允许从外部加载依赖. </p><blockquote><p><code>源码：https://github.com/qq1028951741/springbootdemo or 右上角github进去，springbootdemo项目，如果对您有帮助，麻烦点下star，谢谢</code></p></blockquote><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="SpringBoot整合系列" scheme="https://qq1028951741.github.io/categories/SpringBoot%E6%95%B4%E5%90%88%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="SpringBoot" scheme="https://qq1028951741.github.io/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SspringBoot2.0 设置文件上传大小</title>
    <link href="https://qq1028951741.github.io/2019/04/18/SspringBoot2.0%20%E8%AE%BE%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%A4%A7%E5%B0%8F/"/>
    <id>https://qq1028951741.github.io/2019/04/18/SspringBoot2.0 设置文件上传大小/</id>
    <published>2019-04-18T02:54:13.000Z</published>
    <updated>2019-04-18T02:37:34.289Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="SspringBoot2-0-设置文件上传大小"><a href="#SspringBoot2-0-设置文件上传大小" class="headerlink" title="SspringBoot2.0 设置文件上传大小"></a>SspringBoot2.0 设置文件上传大小</h2><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>SpringBoot2.0 The field file exceeds its maximum permitted size of 1048576 bytes</p><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>SpringBoot 2.0版本:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  servlet:</span><br><span class="line">    multipart:</span><br><span class="line">      enabled: true</span><br><span class="line">      max-file-size: 10Mb</span><br><span class="line">      max-request-size: 100Mb</span><br></pre></td></tr></table></figure></p><p>SpringBoot1.5.9版本:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  http:</span><br><span class="line">    multipart:</span><br><span class="line">      enabled: true</span><br><span class="line">      max-file-size: 10Mb</span><br><span class="line">      max-request-size: 100Mb</span><br></pre></td></tr></table></figure></p><p>或者编写配置bean<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/**  </span><br><span class="line">     * 文件上传配置  </span><br><span class="line">     * @return  </span><br><span class="line">     */  </span><br><span class="line">    @Bean  </span><br><span class="line">    public MultipartConfigElement multipartConfigElement() &#123;  </span><br><span class="line">        MultipartConfigFactory factory = new MultipartConfigFactory();  </span><br><span class="line">        //单个文件最大  </span><br><span class="line">        factory.setMaxFileSize(&quot;10MB&quot;); //KB,MB  </span><br><span class="line">        //设置总上传数据总大小  </span><br><span class="line">        factory.setMaxRequestSize(&quot;100MB&quot;);  </span><br><span class="line">        return factory.createMultipartConfig();  </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="文件上传" scheme="https://qq1028951741.github.io/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>Intellij IDEA 内存优化配置</title>
    <link href="https://qq1028951741.github.io/2019/04/18/Intellij%20IDEA%20%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96%E9%85%8D%E7%BD%AE/"/>
    <id>https://qq1028951741.github.io/2019/04/18/Intellij IDEA 内存优化配置/</id>
    <published>2019-04-18T02:54:13.000Z</published>
    <updated>2019-04-18T02:39:48.263Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="Intellij-IDEA-内存优化配置"><a href="#Intellij-IDEA-内存优化配置" class="headerlink" title="Intellij IDEA 内存优化配置"></a>Intellij IDEA 内存优化配置</h2><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><ul><li>开发机内存8G<h3 id="优化配置"><a href="#优化配置" class="headerlink" title="优化配置"></a>优化配置</h3>idea64.exe.vmoptions<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-server</span><br><span class="line">-Xms128m</span><br><span class="line">-Xmx2048m</span><br><span class="line">-XX:NewRatio=3</span><br><span class="line">-Xss16m</span><br><span class="line">-XX:+UseConcMarkSweepGC</span><br><span class="line">-XX:+CMSParallelRemarkEnabled</span><br><span class="line">-XX:ConcGCThreads=4</span><br><span class="line">-XX:ReservedCodeCacheSize=240m</span><br><span class="line">-XX:+AlwaysPreTouch</span><br><span class="line">-XX:+TieredCompilation</span><br><span class="line">-XX:+UseCompressedOops</span><br><span class="line">-XX:SoftRefLRUPolicyMSPerMB=50</span><br><span class="line">-Dsun.io.useCanonCaches=false</span><br><span class="line">-Djava.net.preferIPv4Stack=true</span><br><span class="line">-Djsse.enableSNIExtension=false</span><br><span class="line">-ea</span><br></pre></td></tr></table></figure></li></ul><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="内存优化配置" scheme="https://qq1028951741.github.io/tags/%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>Maven：禁止依赖自动传递</title>
    <link href="https://qq1028951741.github.io/2019/04/18/Maven%EF%BC%9A%E7%A6%81%E6%AD%A2%E4%BE%9D%E8%B5%96%E8%87%AA%E5%8A%A8%E4%BC%A0%E9%80%92/"/>
    <id>https://qq1028951741.github.io/2019/04/18/Maven：禁止依赖自动传递/</id>
    <published>2019-04-18T02:54:13.000Z</published>
    <updated>2019-04-18T03:09:05.110Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="Maven：禁止依赖自动传递"><a href="#Maven：禁止依赖自动传递" class="headerlink" title="Maven：禁止依赖自动传递"></a>Maven：禁止依赖自动传递</h2><ul><li><p>依赖可选</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;  </span><br><span class="line">    &lt;groupId&gt;com.projecct&lt;/groupId&gt;  </span><br><span class="line">    &lt;artifactId&gt;project2&lt;/artifactId&gt;  </span><br><span class="line">    &lt;version&gt;1.0&lt;/version&gt;  </span><br><span class="line">    &lt;scope&gt;compile&lt;/scope&gt;  </span><br><span class="line">    &lt;optional&gt;true&lt;/optional&gt;  </span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li><li><p>单依赖过滤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;      </span><br><span class="line">     &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt;  </span><br><span class="line">     &lt;artifactId&gt;hbase&lt;/artifactId&gt;  </span><br><span class="line">     &lt;version&gt;0.94.17&lt;/version&gt;   </span><br><span class="line">     &lt;exclusions&gt;    </span><br><span class="line">           &lt;exclusion&gt;        </span><br><span class="line">                &lt;groupId&gt;commons-logging&lt;/groupId&gt;            </span><br><span class="line">                &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;    </span><br><span class="line">           &lt;/exclusion&gt;    </span><br><span class="line">     &lt;/exclusions&gt;    </span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li><li><p>所有依赖过滤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;  </span><br><span class="line">    &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt;  </span><br><span class="line">    &lt;artifactId&gt;hbase&lt;/artifactId&gt;  </span><br><span class="line">    &lt;version&gt;0.94.17&lt;/version&gt;  </span><br><span class="line">    &lt;exclusions&gt;  </span><br><span class="line">        &lt;exclusion&gt;  </span><br><span class="line">            &lt;groupId&gt;*&lt;/groupId&gt;  </span><br><span class="line">            &lt;artifactId&gt;*&lt;/artifactId&gt;  </span><br><span class="line">        &lt;/exclusion&gt;  </span><br><span class="line">    &lt;/exclusions&gt;  </span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li></ul><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="Maven" scheme="https://qq1028951741.github.io/tags/Maven/"/>
    
  </entry>
  
  <entry>
    <title>log4j警告:WARN Please initialize the log4j system properly 的解决方法</title>
    <link href="https://qq1028951741.github.io/2019/04/18/log4j%E8%AD%A6%E5%91%8A%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <id>https://qq1028951741.github.io/2019/04/18/log4j警告的解决方法/</id>
    <published>2019-04-18T02:54:13.000Z</published>
    <updated>2019-04-18T01:50:17.197Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="log4j警告-WARN-Please-initialize-the-log4j-system-properly-的解决方法"><a href="#log4j警告-WARN-Please-initialize-the-log4j-system-properly-的解决方法" class="headerlink" title="log4j警告:WARN Please initialize the log4j system properly 的解决方法"></a>log4j警告:WARN Please initialize the log4j system properly 的解决方法</h2><p>log4j:WARN No appenders could be found for logger(org.springframework.context.support.ClassPathXmlApplicationContext).<br>log4j:WARN Please initialize the log4j system properly.<br>resource下建立log4j.properties<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">log4j.rootLogger=WARN, stdout</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%d %p [%c] - %m%n</span><br></pre></td></tr></table></figure></p><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="log4j" scheme="https://qq1028951741.github.io/tags/log4j/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot 2.0.2中禁用spring security</title>
    <link href="https://qq1028951741.github.io/2019/04/18/SpringBoot%202.0.2%E4%B8%AD%E7%A6%81%E7%94%A8spring%20security/"/>
    <id>https://qq1028951741.github.io/2019/04/18/SpringBoot 2.0.2中禁用spring security/</id>
    <published>2019-04-18T02:54:13.000Z</published>
    <updated>2019-04-25T09:39:31.503Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="SpringBoot-2-0-2中禁用spring-security"><a href="#SpringBoot-2-0-2中禁用spring-security" class="headerlink" title="SpringBoot 2.0.2中禁用spring security"></a>SpringBoot 2.0.2中禁用spring security</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@SpringBootApplication(exclude = &#123;SecurityAutoConfiguration.class&#125;)</span><br></pre></td></tr></table></figure><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="SpringBoot" scheme="https://qq1028951741.github.io/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot application.yml文件不生效</title>
    <link href="https://qq1028951741.github.io/2019/04/18/SpringBoot%20application.yml%E6%96%87%E4%BB%B6%E4%B8%8D%E7%94%9F%E6%95%88/"/>
    <id>https://qq1028951741.github.io/2019/04/18/SpringBoot application.yml文件不生效/</id>
    <published>2019-04-18T02:54:13.000Z</published>
    <updated>2019-04-18T02:37:35.432Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="SpringBoot-application-yml文件不生效"><a href="#SpringBoot-application-yml文件不生效" class="headerlink" title="SpringBoot application.yml文件不生效"></a>SpringBoot application.yml文件不生效</h2><blockquote><p>今天同样遇到了这个问题，而且是其它所有的模块都没问题，只有其中一个模块bootstrap.yml不起作用，检查发现bootstrap文件和其他文件的图标不一致</p></blockquote><p>配置context依赖解决，估计是没加载到yml文件导致<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-context&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="yml文件" scheme="https://qq1028951741.github.io/tags/yml%E6%96%87%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>SpringBootJpa报错No identifier specified for entity</title>
    <link href="https://qq1028951741.github.io/2019/04/18/SpringBootJpa%E6%8A%A5%E9%94%99No%20identifier%20specified%20for%20entity/"/>
    <id>https://qq1028951741.github.io/2019/04/18/SpringBootJpa报错No identifier specified for entity/</id>
    <published>2019-04-18T02:54:13.000Z</published>
    <updated>2019-04-19T01:04:16.161Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="SpringBootJpa报错No-identifier-specified-for-entity"><a href="#SpringBootJpa报错No-identifier-specified-for-entity" class="headerlink" title="SpringBootJpa报错No identifier specified for entity"></a>SpringBootJpa报错No identifier specified for entity</h2><blockquote><p>@Id注解import错包了。</p></blockquote><h3 id="错误："><a href="#错误：" class="headerlink" title="错误："></a>错误：</h3><p><code>import org.springframework.data.annotation.Id;</code></p><h3 id="正确："><a href="#正确：" class="headerlink" title="正确："></a>正确：</h3><p><code>import javax.persistence.*;</code></p><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="开发日常记录" scheme="https://qq1028951741.github.io/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="SpringBootJpa" scheme="https://qq1028951741.github.io/tags/SpringBootJpa/"/>
    
  </entry>
  
  <entry>
    <title>Docker：Jenkins自动构建并生成镜像</title>
    <link href="https://qq1028951741.github.io/2019/04/15/Docker%EF%BC%9AJenkins%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA%E5%B9%B6%E7%94%9F%E6%88%90%E9%95%9C%E5%83%8F/"/>
    <id>https://qq1028951741.github.io/2019/04/15/Docker：Jenkins自动构建并生成镜像/</id>
    <published>2019-04-15T02:54:13.000Z</published>
    <updated>2019-05-09T02:31:36.895Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="Docker：Jenkins自动构建并生成镜像"><a href="#Docker：Jenkins自动构建并生成镜像" class="headerlink" title="Docker：Jenkins自动构建并生成镜像"></a>Docker：Jenkins自动构建并生成镜像</h2><p>Jenkins主要配置svn、maven构建、定时构建、构建完成运行shell脚本生成镜像并运行</p><h3 id="全局工具配置"><a href="#全局工具配置" class="headerlink" title="全局工具配置"></a>全局工具配置</h3><p><img src="/images/docker-jekins1.png" alt="&quot;图片描述&quot;"></p><h3 id="配置svn"><a href="#配置svn" class="headerlink" title="配置svn"></a>配置svn</h3><p><img src="/images/jenkins-docker1.png" alt="&quot;图片描述&quot;"></p><h3 id="maven构建"><a href="#maven构建" class="headerlink" title="maven构建"></a>maven构建</h3><p><img src="/images/jenkins-docker2.png" alt="&quot;图片描述&quot;"></p><h3 id="定时构建"><a href="#定时构建" class="headerlink" title="定时构建"></a>定时构建</h3><p><img src="/images/jenkins-docker3.png" alt="&quot;图片描述&quot;"></p><h3 id="构建完成运行shell脚本生成镜像并运行"><a href="#构建完成运行shell脚本生成镜像并运行" class="headerlink" title="构建完成运行shell脚本生成镜像并运行"></a>构建完成运行shell脚本生成镜像并运行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># jar目录</span><br><span class="line">BASE_PATH=/robotservice2.0</span><br><span class="line"></span><br><span class="line"># 源jar路径  </span><br><span class="line">SOURCE_PATH=/root/.jenkins/workspace  </span><br><span class="line"> </span><br><span class="line"># 删除上次构建jar包</span><br><span class="line">find $BASE_PATH -name &quot;*-0.0.1-SNAPSHOT.jar&quot; | xargs rm </span><br><span class="line"> </span><br><span class="line"># 最新构建代码 移动到项目环境</span><br><span class="line">echo &quot;最新构建代码 $SOURCE_PATH 迁移至 $BASE_PATH ....&quot;</span><br><span class="line">  find /root/.jenkins/workspace -name &quot;*-0.0.1-SNAPSHOT.jar&quot; |xargs -i cp &#123;&#125; $BASE_PATH</span><br><span class="line">echo &quot;迁移完成&quot;</span><br><span class="line"></span><br><span class="line"># 把公共模块放到lib</span><br><span class="line">rm -rf $BASE_PATH/lib/eureka-client-common-0.0.1-SNAPSHOT.jar</span><br><span class="line">mv $BASE_PATH/eureka-client-common-0.0.1-SNAPSHOT.jar $BASE_PATH/lib</span><br></pre></td></tr></table></figure><h3 id="制作镜像"><a href="#制作镜像" class="headerlink" title="制作镜像"></a>制作镜像</h3><p>docker commit 当前运行的容器名 新镜像名:版本号<br>docker commit jenkins jenkins:2.0.0</p><h3 id="上传镜像"><a href="#上传镜像" class="headerlink" title="上传镜像"></a>上传镜像</h3><p>参考镜像上传文章</p><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="Docker 系列" scheme="https://qq1028951741.github.io/categories/Docker-%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Docker" scheme="https://qq1028951741.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker：Linux定时脚本（从jenkins容器取jar包部署）</title>
    <link href="https://qq1028951741.github.io/2019/04/15/Docker%EF%BC%9ALinux%E5%AE%9A%E6%97%B6%E8%84%9A%E6%9C%AC%EF%BC%88%E4%BB%8Ejenkins%E5%AE%B9%E5%99%A8%E5%8F%96jar%E5%8C%85%E9%83%A8%E7%BD%B2%EF%BC%89/"/>
    <id>https://qq1028951741.github.io/2019/04/15/Docker：Linux定时脚本（从jenkins容器取jar包部署）/</id>
    <published>2019-04-15T02:54:13.000Z</published>
    <updated>2019-05-10T08:09:16.025Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="Docker：Linux定时脚本（从jenkins容器取jar包部署）"><a href="#Docker：Linux定时脚本（从jenkins容器取jar包部署）" class="headerlink" title="Docker：Linux定时脚本（从jenkins容器取jar包部署）"></a>Docker：Linux定时脚本（从jenkins容器取jar包部署）</h2><blockquote><p>主要是实现用linux定时脚本定时从jenkins容器取自动构建好的jar生成镜像并运行容器</p></blockquote><h3 id="crontab定时任务服务安装"><a href="#crontab定时任务服务安装" class="headerlink" title="crontab定时任务服务安装"></a>crontab定时任务服务安装</h3><ul><li>安装crontab定时任务服务<br>yum install vixie-cron<br>vixie-cron软件包是cron的主程序<br>yum install crontabs<br>crontabs软件包是用来安装、卸装、或列举用来驱动 cron 守护进程的表格的程序</li><li>开启crontab服务<br>service crond start</li><li>查看crontab服务状态<br>service crond status</li><li>设置为开机启动<br>chkconfig crond on</li><li>设置定时任务<br>crontab配置参考<a href="https://www.cnblogs.com/xd502djj/p/4292781.html" target="_blank" rel="noopener">https://www.cnblogs.com/xd502djj/p/4292781.html</a><ul><li>换到root 的身份 su - root</li><li>crontab -e (按a增加下)</li><li>0 12,18,23 <em> </em> * /robotservice2.0/robotservice.sh -h now   </li><li>保存退出 wq!</li></ul></li><li>列出当前的所有调度任务<br>crontab -l</li></ul><h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><p>  <img src="/images/docker-定时脚本.png" alt="&quot;图片描述&quot;"></p><h3 id="自定义网络"><a href="#自定义网络" class="headerlink" title="自定义网络"></a>自定义网络</h3><p>自定义bridge网络与默认bridge网络对比：</p><ul><li>默认桥接网络中的容器只能通过IP地址访问其他容器（除非使用遗留的-link指令连接两个容器），而自定义桥接网络提供DNS解析，可以通过容器的名字或是别名访问其他容器</li><li>容器可以自由的进入或是退出自定义桥接网络，如果想要退出默认桥接网络，需要先停止容器的运行，然后重新创建该容器，并指定需要连接的其他网络</li><li>如果更改了默认桥接网络的网络配置，需要重新启动docker，并且由于默认桥接网络只有一个，因此所有容器的网络配置都是一样的，而用户自定义网络可以在创建时指定网络配置（例如默认网关、MTU等），不需要重启docker，灵活性更高</li><li>在默认桥接网络中，可以通过–link参数连接两个容器来共享环境变量，用户自定义网络中无法使用这种方式，但是docker提供了更好的方式：                <ul><li>多个容器可以使用docker volume（这是docker存储数据的一种方式，以后会介绍）挂载到同一个文件，在文件中指明环境变量，从而实现所容器的环境变量共享</li><li>多个容器可以使用同一个docker-compose（与docker service有关）文件启动 ，可以在该  件中定义共享环境变量   </li><li>可以使用swarm services，并且通过  secrets 和 configs  （这两个还没看）实现环境变量共享</li></ul></li></ul><h3 id="创建自定义网络"><a href="#创建自定义网络" class="headerlink" title="创建自定义网络"></a>创建自定义网络</h3><ul><li>创建一个自定义网络<br>docker network create docker_network</li><li>查看自定义网络<br>docker network ls</li><li>移除自定义网络<br>docker network rm docker_network</li><li>docker容器运行时指定自定义网络和ip<br>docker run –network=docker_network –ip=172.25.2.1 –name eureka-server -p 1001:1001 -d eureka-server</li><li>断开容器连接<br>docker network disconnect docker_network containername</li></ul><h3 id="shell脚本"><a href="#shell脚本" class="headerlink" title="shell脚本"></a>shell脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"># jenkins容器id</span><br><span class="line">JENKINS_ID=$(docker ps | grep &quot;jenkins&quot; | awk &apos;&#123;print $1&#125;&apos;)</span><br><span class="line"># 复制微服务jar到对应文件夹</span><br><span class="line">docker cp $JENKINS_ID:/robotservice2.0 /</span><br><span class="line"># 删除运行容器</span><br><span class="line">echo &quot;删除容器 ...&quot;</span><br><span class="line">docker ps -a | grep &quot;eureka&quot; | awk &apos;&#123;print &quot;docker stop &quot; $12&#125;&apos; | sh</span><br><span class="line">docker ps -a | grep &quot;config-server-native&quot; | awk &apos;&#123;print &quot;docker stop &quot; $12&#125;&apos; | sh</span><br><span class="line"></span><br><span class="line">docker ps -a | grep &quot;eureka&quot; | awk &apos;&#123;print &quot;docker rm &quot; $12&#125;&apos; | sh</span><br><span class="line">docker ps -a | grep &quot;config-server-native&quot; | awk &apos;&#123;print &quot;docker rm &quot; $12&#125;&apos; | sh</span><br><span class="line">echo &quot;删除容器成功&quot;</span><br><span class="line"># 删除镜像</span><br><span class="line">echo &quot;存在镜像，IID=$IID,删除镜像&quot;</span><br><span class="line">docker images | grep &quot;eureka&quot; | awk &apos;&#123;print &quot;docker rmi &quot; $3&#125;&apos;</span><br><span class="line">docker images | grep &quot;config-server-native&quot; | awk &apos;&#123;print &quot;docker rmi &quot; $3&#125;&apos;</span><br><span class="line">echo &quot;删除镜像成功&quot;</span><br><span class="line"># 生成对应微服务镜像</span><br><span class="line">docker build -t eureka-server --target eureka-server .</span><br><span class="line">docker build -t eureka-client-zipkin --target eureka-client-zipkin .</span><br><span class="line">docker build -t config-server-native --target config-server-native .</span><br><span class="line">docker build -t eureka-gateway --target eureka-gateway .</span><br><span class="line">docker build -t eureka-client-web-jsp --target eureka-client-web-jsp .</span><br><span class="line">docker build -t eureka-client-user --target eureka-client-user .</span><br><span class="line">docker build -t eureka-client-device --target eureka-client-device .</span><br><span class="line">docker build -t eureka-client-patrol --target eureka-client-patrol .</span><br><span class="line">docker build -t eureka-client-qpid --target eureka-client-qpid .</span><br><span class="line">docker build -t eureka-client-report --target eureka-client-report .</span><br><span class="line">docker build -t eureka-client-interactive --target eureka-client-interactive .</span><br><span class="line">docker build -t eureka-client-oauth --target eureka-client-oauth .</span><br><span class="line">docker build -t eureka-client-schedule --target eureka-client-schedule .</span><br><span class="line">docker build -t eureka-client-file --target eureka-client-file .</span><br><span class="line"># 运行镜像</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.1 --name eureka-server -p 1001:1001 -d eureka-server</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.3 --name config-server-native -p 1003:1003 -d config-server-native</span><br><span class="line">sleep 3m</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.2 --name eureka-client-zipkin -p 1002:1002 -d eureka-client-zipkin</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.4 --name eureka-gateway -p 2001:2001 -d eureka-gateway</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.5 --name eureka-client-web-jsp -p 2002:2002 -d eureka-client-web-jsp</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.6 --name eureka-client-user -p 2003:2003 -d eureka-client-user</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.7 --name eureka-client-device -p 2004:2004 -d eureka-client-device</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.8 --name eureka-client-patrol -p 2005:2005 -d eureka-client-patrol</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.9 --name eureka-client-qpid -p 2006:2006 -d eureka-client-qpid</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.10 --name eureka-client-report -p 2007:2007 -d eureka-client-report</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.11 --name eureka-client-interactive -p 2008:2008 -d eureka-client-interactive</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.12 --name eureka-client-oauth -p 2009:2009 -d eureka-client-oauth</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.13 --name eureka-client-schedule -p 2010:2010 -d eureka-client-schedule</span><br><span class="line">docker run --network=docker_network --ip=172.25.2.14 --name eureka-client-file -p 2011:2011 -d eureka-client-file</span><br></pre></td></tr></table></figure><h3 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-server</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-server-0.0.1-SNAPSHOT.jar eureka-server-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 1001</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-server-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-zipkin</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-zipkin-0.0.1-SNAPSHOT.jar eureka-client-zipkin-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 1002</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-zipkin-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS config-server-native</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD config-server-native-0.0.1-SNAPSHOT.jar config-server-native-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 1003</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/config-server-native-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-gateway</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-gateway-0.0.1-SNAPSHOT.jar eureka-gateway-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2001</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-gateway-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-web-jsp</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-web-jsp-0.0.1-SNAPSHOT.jar eureka-client-web-jsp-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2002</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-web-jsp-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-user</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-user-0.0.1-SNAPSHOT.jar eureka-client-user-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2003</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-user-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-device</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-device-0.0.1-SNAPSHOT.jar eureka-client-device-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2004</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-device-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-patrol</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-patrol-0.0.1-SNAPSHOT.jar eureka-client-patrol-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2005</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-patrol-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-qpid</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-qpid-0.0.1-SNAPSHOT.jar eureka-client-qpid-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2006</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-qpid-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-report</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-report-0.0.1-SNAPSHOT.jar eureka-client-report-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2007</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-report-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-interactive</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-interactive-0.0.1-SNAPSHOT.jar eureka-client-interactive-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2008</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-interactive-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-oauth</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-oauth-0.0.1-SNAPSHOT.jar eureka-client-oauth-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2009</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-oauth-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-schedule</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-schedule-0.0.1-SNAPSHOT.jar eureka-client-schedule-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2010</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-schedule-0.0.1-SNAPSHOT.jar&quot;]</span><br><span class="line"></span><br><span class="line">FROM openjdk:8u181-jdk-alpine AS eureka-client-file</span><br><span class="line">VOLUME /tmp</span><br><span class="line">ADD lib /lib</span><br><span class="line">ADD eureka-client-file-0.0.1-SNAPSHOT.jar eureka-client-file-0.0.1-SNAPSHOT.jar</span><br><span class="line">EXPOSE 2011</span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom -Dloader.path=&apos;lib/&apos;&quot;,&quot;-jar&quot;,&quot;/eureka-client-file-0.0.1-SNAPSHOT.jar&quot;]</span><br></pre></td></tr></table></figure><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="Docker 系列" scheme="https://qq1028951741.github.io/categories/Docker-%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Docker" scheme="https://qq1028951741.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker：Docker hub 镜像上传下载</title>
    <link href="https://qq1028951741.github.io/2019/04/14/Docker%EF%BC%9ADocker%20hub%20%E9%95%9C%E5%83%8F%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD/"/>
    <id>https://qq1028951741.github.io/2019/04/14/Docker：Docker hub 镜像上传下载/</id>
    <published>2019-04-14T02:54:13.000Z</published>
    <updated>2019-05-08T07:04:32.672Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="Docker-hub-镜像上传下载"><a href="#Docker-hub-镜像上传下载" class="headerlink" title="Docker hub 镜像上传下载"></a>Docker hub 镜像上传下载</h2><h3 id="注册Docker-hub账号"><a href="#注册Docker-hub账号" class="headerlink" title="注册Docker hub账号"></a>注册Docker hub账号</h3><p><a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a></p><h3 id="Docker-hub账号在验证本地登录"><a href="#Docker-hub账号在验证本地登录" class="headerlink" title="Docker hub账号在验证本地登录"></a>Docker hub账号在验证本地登录</h3><p>docker login</p><h3 id="标记本地镜像"><a href="#标记本地镜像" class="headerlink" title="标记本地镜像"></a>标记本地镜像</h3><p>docker tag : 标记本地镜像，将其归入某一仓库。<br>docker tag IMAGE:TAG REGISTRYHOS/IMAGE:TAG<br>docker tag jenkins-tomcat:1.0.0 dockerhub账号名/jenkins-tomcat:1.0.0</p><h3 id="上传镜像到docker-hub"><a href="#上传镜像到docker-hub" class="headerlink" title="上传镜像到docker hub"></a>上传镜像到docker hub</h3><p>docker push dockerhub账号名/jenkins-tomcat:1.0.0</p><h3 id="docker-hub下载镜像"><a href="#docker-hub下载镜像" class="headerlink" title="docker hub下载镜像"></a>docker hub下载镜像</h3><p>docker pull jenkins-tomcat:1.0.0</p><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="Docker 系列" scheme="https://qq1028951741.github.io/categories/Docker-%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Docker" scheme="https://qq1028951741.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker：Dockerfile-构建jekins镜像</title>
    <link href="https://qq1028951741.github.io/2019/04/13/Docker%EF%BC%9ADockerfile-%E6%9E%84%E5%BB%BAjekins%E9%95%9C%E5%83%8F/"/>
    <id>https://qq1028951741.github.io/2019/04/13/Docker：Dockerfile-构建jekins镜像/</id>
    <published>2019-04-13T02:54:13.000Z</published>
    <updated>2019-05-09T06:04:56.064Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="Docker：Dockerfile-构建jekins镜像"><a href="#Docker：Dockerfile-构建jekins镜像" class="headerlink" title="Docker：Dockerfile-构建jekins镜像"></a>Docker：Dockerfile-构建jekins镜像</h2><ul><li><p>Dockerfile</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">FROM centos:7 </span><br><span class="line"></span><br><span class="line"># author info</span><br><span class="line">MAINTAINER zyf</span><br><span class="line"></span><br><span class="line"># install wget to download files</span><br><span class="line">RUN yum install wget -y</span><br><span class="line"></span><br><span class="line"># install git</span><br><span class="line">RUN yum install git -y</span><br><span class="line"></span><br><span class="line">RUN mkdir /robotservice2.0 /robotservice2.0/lib </span><br><span class="line"></span><br><span class="line">RUN cd /opt</span><br><span class="line"></span><br><span class="line"># download jdk</span><br><span class="line">RUN wget -P /opt --no-check-certificate --no-cookies --header &quot;Cookie: oraclelicense=accept-securebackup-cookie&quot; http://download.oracle.com/otn-pub/java/jdk/8u131-b11/d54c1d3a095b4ff2b6607d096fa80163/jdk-8u131-linux-x64.tar.gz</span><br><span class="line"></span><br><span class="line"># download maven</span><br><span class="line">RUN wget -P /opt http://mirror.bit.edu.cn/apache/maven/maven-3/3.5.4/binaries/apache-maven-3.5.4-bin.tar.gz</span><br><span class="line"></span><br><span class="line"># download tomcat</span><br><span class="line">RUN wget -P /opt http://mirror.bit.edu.cn/apache/tomcat/tomcat-8/v8.5.40/bin/apache-tomcat-8.5.40.tar.gz</span><br><span class="line"></span><br><span class="line"># unzip jdk</span><br><span class="line">RUN tar -xvf /opt/jdk-8u131-linux-x64.tar.gz -C /opt/</span><br><span class="line"></span><br><span class="line"># unzip maven</span><br><span class="line">RUN tar -xvf /opt/apache-maven-3.5.4-bin.tar.gz -C /opt/</span><br><span class="line"></span><br><span class="line"># unzip tomcat</span><br><span class="line">RUN tar -xvf /opt/apache-tomcat-8.5.40.tar.gz -C /opt</span><br><span class="line"></span><br><span class="line"># set environment</span><br><span class="line">ENV JAVA_HOME /opt/jdk1.8.0_131</span><br><span class="line">ENV MAVEN_HOME /opt/apache-maven-3.5.4</span><br><span class="line">ENV CLASSPATH .:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line">ENV PATH $JAVA_HOME/bin:$MAVEN_HOME/bin:$PATH</span><br><span class="line">ENV JAVA_TOOL_OPTIONS -Dfile.encoding=UTF8</span><br><span class="line"></span><br><span class="line"># download jenkins</span><br><span class="line">RUN wget -P /opt/apache-tomcat-8.5.40/webapps https://mirrors.tuna.tsinghua.edu.cn/jenkins/war-stable/2.164.2/jenkins.war</span><br><span class="line"></span><br><span class="line"># startup tomcat</span><br><span class="line">CMD /opt/apache-tomcat-8.5.40/bin/catalina.sh run</span><br><span class="line"></span><br><span class="line"># expose memcached port</span><br><span class="line">EXPOSE 8080</span><br></pre></td></tr></table></figure></li><li><p>编译Dockerfile<br>docker build -t jenkins:1.0.0 .</p></li><li><p>运行容器<br>docker run –name jenkins -p 9090:8080 -p 50000:50000 -v /var/run/docker.sock:/var/run/docker.sock -v $(which docker):/bin/docker -v /var/jenkins_home:/var/jenkins_home -d jenkins:1.0.0    </p></li><li><p>访问<br>http://<em>**</em>:9090/jenkins</p></li><li><p>进入容器<br>docker exec -it containerId /bin/bash</p></li><li><p>查看jenkins密码<br>cat /root/.jenkins/secrets/initialAdminPassword</p></li></ul><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="Docker 系列" scheme="https://qq1028951741.github.io/categories/Docker-%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Docker" scheme="https://qq1028951741.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Docker：Docker使用</title>
    <link href="https://qq1028951741.github.io/2019/04/12/Docker%EF%BC%9ADocker%E4%BD%BF%E7%94%A8/"/>
    <id>https://qq1028951741.github.io/2019/04/12/Docker：Docker使用/</id>
    <published>2019-04-12T02:54:13.000Z</published>
    <updated>2019-05-10T03:00:40.501Z</updated>
    
    <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><a id="more"></a><the rest="" of="" contents="" |="" 余下全文=""></the></excerpt></p><h2 id="Docker：Docker使用"><a href="#Docker：Docker使用" class="headerlink" title="Docker：Docker使用"></a>Docker：Docker使用</h2><h3 id="相关命令"><a href="#相关命令" class="headerlink" title="相关命令"></a>相关命令</h3><p><img src="/images/镜像管理.png" alt="&quot;图片描述&quot;"><br><img src="/images/容器管理.png" alt="&quot;图片描述&quot;"></p><h3 id="Docker-安装mysql"><a href="#Docker-安装mysql" class="headerlink" title="Docker 安装mysql"></a>Docker 安装mysql</h3><ul><li>查找 mysql 镜像<br>命令：docker search mysql</li><li>下载镜像到本地<br>命令：docker pull mysql:5.6</li><li>确认镜像已被下载<br>命令：docker images |grep mysql</li><li>运行容器<br>命令：<br>docker run -p 3306:3306 –name mysql -v $PWD/conf:/etc/mysql/conf.d -v $PWD/logs:/logs -v $PWD/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=orcl -d mysql:5.6<br>说明：<br>-p 3306:3306：将容器的 3306 端口映射到主机的 3306 端口。<br>-v -v $PWD/conf:/etc/mysql/conf.d：将主机当前目录下的 conf/my.cnf 挂载到容器的 /etc/mysql/my.cnf。<br>-v $PWD/logs:/logs：将主机当前目录下的 logs 目录挂载到容器的 /logs。<br>-v $PWD/data:/var/lib/mysql ：将主机当前目录下的data目录挂载到容器的 /var/lib/mysql 。<br>-e MYSQL_ROOT_PASSWORD=123456：初始化 root 用户的密码</li><li>查看容器启动情况<br>docker ps|grep mysql</li></ul><h3 id="mysql容器中运行-sql文件"><a href="#mysql容器中运行-sql文件" class="headerlink" title="mysql容器中运行.sql文件"></a>mysql容器中运行.sql文件</h3><ul><li>进入容器<br>docker exec -it mysql bash</li><li>创建sql文件夹<br>mkdir sql<br>exit</li><li>将文件copy进容器<br>docker cp 本地文件路径 ID全称:容器路径[docker cp mysql.sql 12345:/tmp/]</li><li>进入容器<br>docker exec -it mysql bash</li><li>进入mysql服务<br>mysql -u root -p </li><li>创建数据库<br>CREATE DATABASE IF NOT EXISTS RUNOOB DEFAULT CHARSET utf8 COLLATE utf8_general_ci;</li><li>查看数据库<br>show databases;</li><li>进入数据库<br>use database</li><li>执行sql文件<br>source  /sql/robot_v2.sql</li><li>查看所有表<br>show tables;</li></ul><h3 id="Docker-安装-Redis"><a href="#Docker-安装-Redis" class="headerlink" title="Docker 安装 Redis"></a>Docker 安装 Redis</h3><ul><li>查找Docker Hub上的redis镜像<br>命令：docker search  redis</li><li>拉取官方的镜像<br>命令：docker pull  redis:3.2</li><li>使用redis镜像<br>命令：<br>docker run –network=docker_network –ip=172.25.1.2 -p 6379:6379 –name redis -v $PWD/data:/data  -d redis:3.2 redis-server –appendonly yes<br>命令说明：<br>-p 6379:6379 : 将容器的6379端口映射到主机的6379端口<br>-v $PWD/data:/data : 将主机中当前目录下的data挂载到容器的/data<br>redis-server –appendonly yes : 在容器执行redis-server启动命令，并打开redis持久化配置</li><li>查看容器启动情况<br>命令：docker ps | grep redis</li><li>连接、查看容器<br>使用redis镜像执行redis-cli命令连接到刚启动的容器,主机IP为***<br><code>docker exec -it 容器id redis-cli</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">172.17.0.1:6379&gt; info</span><br><span class="line"># Server</span><br><span class="line">redis_version:3.2.0</span><br><span class="line">redis_git_sha1:00000000</span><br><span class="line">redis_git_dirty:0</span><br><span class="line">redis_build_id:f449541256e7d446</span><br><span class="line">redis_mode:standalone</span><br><span class="line">os:Linux 4.2.0-16-generic x86_64</span><br><span class="line">arch_bits:64</span><br><span class="line">multiplexing_api:epoll</span><br></pre></td></tr></table></figure></li></ul><hr><blockquote class="blockquote-center"><p>人生两苦：想要却不得，拥有却失去。  –褚禄山<br>            珍惜当下,与君共勉~</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;excerpt in=&quot;&quot; index=&quot;&quot; |=&quot;&quot; 首页摘要=&quot;&quot;&gt;
    
    </summary>
    
      <category term="Docker 系列" scheme="https://qq1028951741.github.io/categories/Docker-%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="Docker" scheme="https://qq1028951741.github.io/tags/Docker/"/>
    
  </entry>
  
</feed>
